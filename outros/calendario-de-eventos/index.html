<!-- Código original feito por Derek: https://codepen.io/moongoat/pen/PEeWON 
Código modificado por mim: Nicole - www.nikkoin.art -->

<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="icon" href="https://i.postimg.cc/8P2rwWhK/famlogo.png">

    <title>Calendário Acadêmico</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

        /* Personaliza a barra de rolagem inteira */
        ::-webkit-scrollbar {
            width: 14px;
        }

        /* Personaliza o fundo da barra de rolagem */
        ::-webkit-scrollbar-track {
            background: #0e2e7c;
        }

        /* Personaliza a barra de rolagem em si */
        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.5);
            border: 3px solid #0e2e7c;
            border-radius: 10px;

        }

        /* Personaliza a barra de rolagem quando você passa o mouse sobre ela */
        ::-webkit-scrollbar-thumb:hover {
            background: white;
        }

        .teste {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
            margin-left: 10px;
            margin-right: 10px;
        }

        .barra {
            max-width: 600px;
            background-color: white;
            margin: 10px;
            border-radius: 5px;
            height: 60px;
            text-decoration: none;
            display: flex;
            align-items: center;
            padding-left: 20px;
            padding-right: 10px;
            border: 2px solid #5d378d;

        }

        .barra:hover {
            background-color: #ebebeb;
        }

        img {
            height: 40px;
            padding: 10px;
            padding-right: 10px;
        }

        .pezinho {
            font-family: 'ubuntu';
            font-size: 18px;
            color: #000;
            font-weight: 500;
        }

        body {
            background-color: #0e2e7c;
        }

        h1 {
            font-family: 'Source Sans 3', sans-serif;
            color: #0e2e7c;
            margin-bottom: -20px;
            font-weight: 800;
            text-align: center;
            font-size: 42px;

        }

        p {
            font-family: 'Source Sans 3', sans-serif;
            text-align: center;
        }

        .keke {
            font-size: 14px;
            margin-top: 0;
        }

        .caixinha {
            max-width: 960px;
            display: block;
            background-color: white;
            border-radius: 5px;
            margin: 20px auto;
            padding: 10px;
            padding-bottom: 30px;
        }


        html {
            overflow-y: scroll;
            overflow-x: hidden;
        }

        .divbody {
            background-color: #0e2e7c;
            width: 100%;
            height: fit-content;
            display: flex;
            justify-content: center;
            margin-top: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        h3:hover {
            color: #e53888;
            text-decoration: none;

        }

        a {
            color: #45b7e5;
            text-decoration: none;
        }

        a:hover {
            color: #0e2e7c;
        }

        .orange {
            color: rgba(227, 78, 0, 1);

        }

        .e2 {
            font-family: 'Source Sans 3', sans-serif;
        }

        #calendar-list {
            font-family: 'Source Sans 3', sans-serif;
            max-width: 700px;
            padding-top: 30px;
            padding: 10px;
        }

        #calendar-container {
            margin: 20px auto;
            max-width: 960px;
            background-color: none;
            padding: 20px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            flex-direction: column;
        }


        .date-box {
            width: 75px;
            font-size: 1em;
            float: left;
            color: white;
        }

        .date-month {
            display: block;
            line-height: 1;
            margin-bottom: -15px;
            text-align: center;
        }

        .date-day {
            display: block;
            font-size: 3.5em;
            font-weight: bold;
            text-align: center;
        }

        #calendar-list ol {
            list-style-type: none;
            margin: 0 0 1.5em 0;
            padding: 0;
            display: block;
        }

        .events {
            display: block;
            padding-left: 75px;
        }

        .calendar-title {
            display: block;
            font-size: 22px;
            cursor: pointer;
            margin-left: 20px;
            background-color: white;
            border-radius: 5px;
            padding: 17px 20px 17px 20px;
            color: #000;
            width: 512px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 0;
        }

        @media (max-width: 700px) {
            .calendar-title {
                width: auto;
                max-width: 512px;
                white-space: normal;
                text-overflow: none;
            }
        }

        .calendar-title:hover {
            text-decoration: none;
        }

        .info {
            display: block;
            padding: 20px;
            border-radius: 5px;
        }

        .events {
            margin-top: 10px;
        }

        .event-details {
            display: none;
            font-family: 'Source Sans 3', sans-serif;
            font-size: 16px;
            font-weight: 800;
            color: #252525;
            background-color: white;
            border-radius: 5px;
            padding: 10px;
            margin-left: 20px;
            max-width: 532px;
            margin-top: 5px;
        }

        .event-description {
            margin-left: 20px;
            /*ajuste o valor como você precisa*/
            margin-bottom: 20px;
            pointer-events: none;
        }

        .event-description-texto {
            font-family: 'Source Sans 3', sans-serif;
            text-align: justify;
            margin-left: 20px;
            margin-right: 20px;
            text-decoration: none;
            font-style: italic;
            color: #414141;
            font-weight: 500;
            margin-top: 0;

        }

        .event-description-agenda {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 14px;
            margin-left: 20px;
            margin-right: 20px;
            margin-bottom: 0px;
        }

        .start-time {
            color: #3eb288;
            font-weight: 900;

        }

        .end-time {
            color: #e53888;
            font-weight: 900;
        }

        .event-description-local {
            margin-left: 20px;
            margin-right: 20px;
            margin-top: 0;
            margin-bottom: -20px;
        }

        .event-location {
            display: block;
            /* Garante que o elemento seja tratado como bloco */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 450px;
            /* Defina a porcentagem desejada aqui */
            color: #45b7e5;
            font-size: 14px;
            max-width: 205px;

        }

        .event-location:hover {
            color: #0e2e7c;
        }

        .event-description-horario {
            margin-bottom: -22px;
            margin-left: 20px;
            margin-top: 10px;
            pointer-events: none;
        }

        .clock-icon {
            font-size: 18px;
            color: #000;
            /* Adicione a cor desejada aqui */
        }

        .events>li.cal:not(:last-child) {
            margin-bottom: -10px;
        }
    </style>
</head>

<body>

    <div class="caixinha">
        <h1> Calendário de Eventos</h1>
        <p>Acompanhe de forma dinâmica os diversos eventos da sua faculdade ;)</p>

    </div>

    <div class="divbody">
        <div id="calendar-container">
            <div class="juntar">
                <div id="calendar-list">
                </div>
            </div>
        </div>
    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/locale/pt-br.min.js"
        integrity="sha512-1IpxmBdyZx3okPiZ14mzw6+pOGa690uDmcdjqvT310Kwv3NRcjvL/aOtoSprEyvkDdAb7ZtM2um6KrLqLOY97w=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        moment.locale('pt');

        //string date to start the list range.
        //recommend using Date.now() to filter out past events
        var startDate = Date.now();
        var items = [];
        $.getJSON(
            "https://www.googleapis.com/calendar/v3/calendars/c_fc9f288bf9f61ff657c6c2d173f7aa952897a465c91d14d941d4d37738c350b8@group.calendar.google.com/events?key=AIzaSyCrPzedxOXMEoXd5dzdF9hDOAkjcb3lsL0&singleEvents=true&orderBy=starttime&maxResults=10&timeMin=" + new Date(startDate).toISOString(),
            function (data) {
                $.each(data["items"], function (key, val) {
                    items.push(startDate(val["start"]));
                });
                items = items.slice().sort();
                items = [...new Set(items)];

                var events = {};
                items.forEach(function (item) {
                    $.each(data["items"], function (key, val) {
                        if (item == startDate(val["start"])) {
                            //console.log(val);
                            if (events[item] === undefined) {
                                events[item] = new Array();
                            }

                            events[item].push({
                                'eventTitle': val["summary"],
                                'eventDescr': val["description"] === undefined ? "<i>No Event Description</i>" : val["description"],
                                'startTime': startTime(val["start"]),
                                'endDate': moment(startDate(val["end"])).format('l'),
                                'endTime': startTime(val["end"]),
                                'eventLocation': val["location"],  // nova linha para obter a localização
                                'htmlLink': val["htmlLink"]
                            });
                            //console.log(events);
                            //console.log(val);
                        }

                    });
                });
                var markup = "";
                items.forEach(function (eventDate) {
                    var monthName = moment(eventDate).format("MMMM").toUpperCase();
                    var monthDate = moment(eventDate).format("DD");
                    markup += "<ol class='info clearfix'>";
                    markup += "<div class='date-box'>";
                    markup += "<span class='date-month'>" + monthName + "</span>";
                    markup += "<span class='date-day'>" + monthDate + "</span>";
                    markup += "</div><div class='events'>";
                    events[eventDate].forEach(function (event) {
                        console.log(event);
                        markup += "<li class='cal'>";
                        markup += "<h3 class='calendar-title'>" + event["eventTitle"] + "</h3>";
                        markup += "<div class='event-details'>";
                        markup += "<div class='event-description-horario'><i class='fa fa-clock-o'></i><span class='start-time'> " + event["startTime"] + "</span> às <span class='end-time'>" + event["endTime"] + "</span><br/><br/></div>";
                        markup += "<div class='event-description'>Data: " + event["endDate"] + "<br/></div>";
                        if (event["eventLocation"]) {
                            markup += "<div class='event-description-local'>Local: <span class='event-location'><a href='https://www.google.com/maps/search/?api=1&query=" + encodeURIComponent(event["eventLocation"]) + "' target='_blank'>" + event["eventLocation"] + "</a></span><br/><br/></div>";
                        }
                        markup += "<div class='event-description-texto'>" + event["eventDescr"] + "<br/><br/></div>";

                        markup += "<div class='event-description-agenda'><a href='" + event["htmlLink"] + "'>Veja esse Evento no Google Agenda</a><br/><br/></div>";
                        markup += "</div></li>"
                    });
                    markup += "</span></ol></div></div>";
                });
                $("#calendar-list").append(markup);
                //console.log(events);

                function startDate(d) {
                    if (d["dateTime"] === undefined) return d["date"];
                    else {
                        var formatted = new Date(d["dateTime"]);
                        var day = formatted.getDate();
                        var month = formatted.getMonth() + 1;
                        var year = formatted.getFullYear();
                        return year + "-" + pad(month) + "-" + pad(day);
                    }
                }

                function startTime(d) {
                    if (d["dateTime"] === undefined) return "O dia todo";
                    else {
                        var formatted = new Date(d["dateTime"]);
                        return moment(d["dateTime"]).format('LT');
                    }
                }

                function pad(n) {
                    return n < 10 ? "0" + n : n;
                }

                $(".events").click(function (e) {
                    $(e.target)
                        .next("div")
                        .siblings("div")
                        .slideUp();
                    $(e.target)
                        .next("div")
                        .slideToggle();
                });
            }
        );

    </script>
</body>

</html>